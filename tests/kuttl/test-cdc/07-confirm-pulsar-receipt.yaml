apiVersion: kuttl.dev/v1beta1
kind: TestStep
commands: 
- script: |
    PULSAR_POD=$(kubectl get pods -l=app=pulsar -l=component=bastion -o=jsonpath='{.items[0].metadata.name}')
    cmd=$(cat <<EOF
    /pulsar/bin/pulsar-client consume \
      -s new_subs \
      --subscription-position Earliest \
      persistent://public/default/events-cdc-ks1.testtable > topic-contents.log
    EOF
    )
    kubectl exec $PULSAR_POD -- bash -c $cmd
  ignoreFailure: false