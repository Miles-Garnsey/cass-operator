apiVersion: kuttl.dev/v1beta1
kind: TestStep
commands: 
- script: |
    kubectl apply -f config/testutils-deployment.yaml
  ignoreFailure: false
- script: |
    TESTUTILS_POD=$(kubectl get pods -l=app=cdc-testutil -o=jsonpath='{.items[0].metadata.name}')
    kubectl wait --for=condition=Ready pod $TESTUTILS_POD
    until kubectl exec $TESTUTILS_POD -- bash -c "/opt/bin/pulsar-cdc-testutil --cass-contact-points test-cluster-dc1-all-pods-service.cass-operator.svc.cluster.local:9042 --pulsar-url pulsar://pulsar-proxy.pulsar.svc.cluster.local:6650 --pulsar-admin-url http://pulsar-proxy.pulsar.svc.cluster.local:8080 --pulsar-cass-contact-point test-cluster-dc1-all-pods-service.cass-operator.svc.cluster.local"; do sleep 10; done
  ignoreFailure: false